
<!--
 ================================================================================================================
 # ===============================================================================================================
 # Copyright 2025 Infosys Ltd.
 # Use of this source code is governed by Apache License Version 2.0 that can be found in the LICENSE file or at
 # http://www.apache.org/licenses/
 # ===============================================================================================================
 ================================================================================================================
-->
<div class="row" style="margin-top: 8px; margin-bottom: 8px; margin-right: 16px;">
    <div class="col-md-6" style="display: flex;justify-content: right;">
        <ng-container *ngIf="model.isBtnDisabled">
            <tr>
                <td>
                    <div class="loading-dots">
                        <div class="loading-dots--dot"></div>
                        <div class="loading-dots--dot"></div>
                        <div class="loading-dots--dot"></div>
                    </div>
                </td>
            </tr>
        </ng-container>
    </div>
    <div class="col-md-6" style="display: flex;justify-content: right;">
        <button mat-flat-button class="tf_button" matTooltip="Submit" matTooltipPosition="above"
            (click)="open(confirmAction)" [disabled]="model.isBtnDisabled">
            Submit
        </button>
    </div>
</div>
<div style="padding: 0px 24px 0px 24px;">
    <div class="tf_panel" [style.height.px]="model.jobHeight" style="overflow-y: auto; overflow-x: hidden;">
        <div class="row" style="padding: 24px">
            <!--name-->
            <div class="col-md-3">
                <mat-form-field appearance="standard" floatLabel="always" style="border-top-width: 0px;">
                    <mat-label>Name</mat-label>
                    <input matInput placeholder="" value="{{ model.benchmarkData.name }}"
                        [(ngModel)]="model.benchmarkData.name" (input)="onInput($event, myName)" #myName="ngModel"
                        required maxlength="40" />
                </mat-form-field>
            </div>
            <!---description--->
            <div class="col-md-3">
                <mat-form-field appearance="standard" floatLabel="always">
                    <mat-label>Description</mat-label>
                    <input matInput placeholder="" value="{{ model.benchmarkData.description }}"
                        [(ngModel)]="model.benchmarkData.description" #myDescription="ngModel" />
                </mat-form-field>
            </div>
            <!--benchmark type-->
            <div class="col-md-3">
                <mat-form-field appearance="standard" floatLabel="always">
                    <mat-label>Modality</mat-label>
                    <mat-select disableOptionCentering class="mat-select-dropdown"
                        [ngModel]="model.benchmarkData.type ? model.benchmarkData.type : ''"
                        (ngModelChange)="model.benchmarkData.type = $event"
                        (selectionChange)="onModalityChange($event.value)" required>
                        <mat-option *ngFor="let type of modality" [value]="type">
                            {{ type }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <!--task-->
            <div class="col-md-3">
                <mat-form-field appearance="standard" floatLabel="always">
                    <mat-label>Task</mat-label>
                    <mat-select disableOptionCentering class="mat-select-dropdown"
                        [ngModel]="model.benchmarkData.configuration.task ? model.benchmarkData.configuration.task : ''"
                        (ngModelChange)="model.benchmarkData.configuration.task = $event"
                        (selectionChange)="onTaskChange($event.value)">
                        <mat-option *ngFor="let task of taskList" [value]="task">
                            {{ task }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
        </div>
        <!--models-->
        <div class="table-titleArea" style="padding: 0px 16px 24px 16px;">
            <div class="marB8">
                <h5 (click)="toggleShowSection('models')"
                    style="color:black; display: flex; justify-content: space-between;">
                    Models
                    <mat-icon class="float-right large-icons" style="font-size: large;"
                        [ngClass]="showSection['models'] ? 'up-arrow' : 'down-arrow'">
                        {{showSection['models'] ? 'arrow_drop_up' : 'arrow_drop_down'}}
                    </mat-icon>
                </h5>
            </div>
            <!--configuration-->
            <div class="tab-data" *ngIf="showSection['models']">
                <ng-container *ngFor="let item of model.benchmarkData.configuration.model; let i=index">
                    <div class="table-titleArea" style="padding: 0px 16px 16px 16px;">
                        <div style="margin-bottom: 8px;">
                            <h6 style="display: flex; justify-content: space-between;">
                                Configuration
                                <span>
                                    <button mat-flat-button (click)="removeModel(i)">
                                        <mat-icon class="action-icons">delete</mat-icon>
                                    </button>
                                </span>
                            </h6>
                        </div>
                        <div class="tab-data" *ngIf="showSection['modelConfig']">
                            <div class="row" style="padding: 8px 24px 16px 24px;">
                                <div class="col-md-3">
                                    <!-- check if the app is integrated or standalone and show dropdown or textbox respectively -->
                                    <div *ngIf="model.urlCheck">
                                        <mat-form-field appearance="standard" floatLabel="always">
                                            <mat-label>Model Name</mat-label>
                                            <!-- <input type="text" placeholder="" matInput [matAutocomplete]="auto" [(ngModel)]="item.modelName"
                                           [ngModelOptions]="{ updateOn: 'blur' }"  #myEndpointName="ngModel" required>
                                        <mat-select #auto="matAutocomplete" (optionSelected)="onModelChange($event, i)">
                                          <mat-option *ngFor="let option of model.modelListData" [value]="option.name" [id]="option.artifacts.uri">
                                            {{option.name}}
                                          </mat-option>
                                        </mat-autocomplete>-->
                                            <mat-select disableOptionCentering class="mat-select-dropdown"
                                                (selectionChange)="onModelChange($event, i)" required>
                                                <!--style="width: 340px;"-->
                                                <mat-option *ngFor="let option of model.modelListData" [value]="option">
                                                    {{ option.name }}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div *ngIf="!model.urlCheck">
                                        <mat-form-field appearance="standard" floatLabel="always">
                                            <mat-label>Model Name</mat-label>
                                            <input matInput placeholder="" value="{{ item.modelName }}"
                                                [(ngModel)]="item.modelName" (input)="onInput($event, modelName)"
                                                #modelName="ngModel" required />
                                        </mat-form-field>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <mat-form-field appearance="standard" floatLabel="always">
                                        <mat-label>Model Path</mat-label>
                                        <div class="mat-prefix">
                                            <span>{{model.aiClouds3}}</span>
                                            <input matInput placeholder="" value="{{ item.modelPathorId }}"
                                                [(ngModel)]="item.modelPathorId" required />
                                        </div>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-3">
                                    <mat-form-field appearance="standard" floatLabel="always">
                                        <mat-label>Data Type</mat-label>
                                        <mat-select disableOptionCentering class="mat-select-dropdown"
                                            [ngModel]="item.datatype ? item.datatype : ''"
                                            (ngModelChange)="onDataTypeChange($event, i)" required>
                                            <!--style="width: 340px;"-->
                                            <mat-option *ngFor="let type of dataType" [value]="type">
                                                {{ type }}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-3">
                                    <mat-form-field appearance="standard" floatLabel="always">
                                        <mat-label>Quantization Method</mat-label>
                                        <mat-select disableOptionCentering class="mat-select-dropdown"
                                            [ngModel]="item.quantizeMethod"
                                            (ngModelChange)="item.quantizeMethod = $event"
                                            [disabled]="model.disableQuantize[i]">
                                            <ng-container *ngIf="!model.disableQuantize[i]">
                                                <mat-option *ngFor="let type of quantizeMethod" [value]="type">
                                                    {{type}}
                                                </mat-option>
                                            </ng-container>
                                            <ng-container *ngIf="model.disableQuantize[i]">
                                                <mat-option *ngFor="let type of quantizeNA" [value]="type">
                                                    {{type}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- arguments -->
                    <div *ngIf="showArgs(i)">
                        <div class="table-titleArea" style="padding-left: 48px;">
                            <div style="margin-bottom: 8px;">
                                <h3 (click)="toggleShowSection('modelArguments')"
                                    style="display: flex; justify-content: space-between;" aria-required="true">
                                    <h6 style="font-weight: 700;">Arguments
                                        <span style="font-size: 12px;"> &#65290; </span>
                                    </h6>
                                    <mat-icon class="float-right large-icons" style="font-size: large;float: right"
                                        [ngClass]="showSection['modelArguments'] ? 'up-arrow' : 'down-arrow'">
                                        {{showSection['modelArguments'] ? 'arrow_drop_up' : 'arrow_drop_down'}}
                                    </mat-icon>
                                </h3>
                            </div>
                            <div class="tab-data" *ngIf="showSection['modelArguments']">
                                <table class="app_tables">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            &nbsp;
                                            <th>Value</th>
                                            &nbsp;
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <ng-container>
                                            <tr *ngFor="let arg of item.args; let j=index">
                                                <td>
                                                    <mat-form-field appearance="standard" floatLabel="always"
                                                        style="width: -webkit-fill-available;">
                                                        <mat-select disableOptionCentering class="mat-select-dropdown"
                                                            [ngModel]="arg.name ? arg.name : ''"
                                                            (ngModelChange)="arg.name = $event" required>
                                                            <mat-option *ngFor="let type of modelGenArgs"
                                                                [value]="type">
                                                                {{ type }}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </td>
                                                &nbsp;
                                                <td>
                                                    <mat-form-field appearance="standard" floatLabel="always"
                                                        style="width: -webkit-fill-available;">
                                                        <input matInput placeholder="" value="{{ arg.value }}"
                                                            [(ngModel)]="arg.value" required />
                                                    </mat-form-field>
                                                </td>
                                                &nbsp;
                                                <td>
                                                    <button mat-flat-button (click)="removeArgs(i,j)">
                                                        <mat-icon class="action-icons">delete</mat-icon>
                                                    </button>
                                                </td>
                                            </tr>
                                        </ng-container>
                                    </tbody>
                                </table>
                                <button mat-flat-button class="highlight-button" (click)="addArgs(i)" [disabled]="canAddArgs(i)">
                                    <mat-icon class="action-icons">add</mat-icon>
                                    Add Arguments
                                </button>
                            </div>
                        </div>
                    </div>
                </ng-container>
                <button mat-flat-button class="highlight-button" (click)="addModel()"
                    [disabled]="model.modelBtnDisable">
                    <mat-icon class="action-icons">add</mat-icon>
                    Add Models
                </button>
            </div>
        </div>

        <!-- Dataset Configuration -->
        <div class="table-titleArea" style="padding: 0px 16px 24px 16px;">
            <div style="margin-bottom: 8px;">
                <h5 (click)="toggleShowSection('data')" style="display: flex; justify-content: space-between;"
                    aria-required="true">
                    <h5>Dataset Configuration
                        <span style="font-size: 12px;"> &#65290; </span>
                    </h5>
                    <mat-icon class="float-right large-icons" style="font-size: large;float: right"
                        [ngClass]="showSection['data'] ? 'up-arrow' : 'down-arrow'">
                        {{showSection['data'] ? 'arrow_drop_up' : 'arrow_drop_down'}}
                    </mat-icon>
                </h5>
            </div>
            <div class="tab-data" *ngIf="showSection['data']">
                <table class="app_tables">
                    <thead>
                        <tr>
                            <th>Scope</th>
                            &nbsp;
                            <th>Name</th>
                            &nbsp;
                            <th>Language</th>
                            &nbsp;
                            <!-- <ng-container
                            *ngIf="showBatchAndLimit()"> -->
                            <th>Batch Size</th>
                            &nbsp;
                            <th>Limit</th>
                            <!-- </ng-container> -->
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of model.benchmarkData.configuration.data; let i=index">
                            <td>
                                <mat-form-field appearance="standard" floatLabel="always">
                                    <mat-select disableOptionCentering class="mat-select-dropdown"
                                        [ngModel]="item?.scope ? item.scope: ''" 
                                        (ngModelChange)="item.scope = $event"
                                        (selectionChange)="onScopeChange($event.value)" 
                                        required> <!--style="width: 200px;"-->
                                        <mat-option *ngFor="let type of scope" [value]="type">
                                            {{ type }}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </td>
                            &nbsp;
                            <td>
                                <div *ngIf="item?.scope == 'public' ">
                                    <mat-form-field appearance="standard" floatLabel="always">
                                        <mat-select disableOptionCentering class="mat-select-dropdown"
                                            [ngModel]="item?.name ? item.name: ''" (ngModelChange)="item.name = $event"
                                            required> <!--style="width: 200px;"-->
                                            <mat-option *ngFor="let type of model.publicDatasets" [value]="type">
                                                {{ type }}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <div *ngIf="item?.scope != 'public' ">
                                    <mat-form-field class="standard" floatLabel="always">
                                        <input type="text" matInput [matAutocomplete]="auto"
                                            [ngModel]="item?.name ? item.name: ''" (ngModelChange)="item.name = $event"
                                            #myEndpointName="ngModel" required>
                                        <mat-autocomplete #auto="matAutocomplete">
                                            <mat-option *ngFor="let type of model.infyDatasets" [value]="type">
                                                {{type}}
                                            </mat-option>
                                        </mat-autocomplete>
                                    </mat-form-field>
                                </div>
                            </td>
                            &nbsp;
                            <td>
                                <mat-form-field appearance="standard" floatLabel="always">
                                    <input matInput placeholder="" value="{{ item.language }}"
                                        [(ngModel)]="item.language" maxlength="15" required pattern="[a-zA-Z]+"
                                        onkeypress="return (event.charCode > 64 && event.charCode < 91) || (event.charCode > 96 && event.charCode < 123)" />
                                    <!--style="width: 185px;" -->
                                    <!-- [disabled]="model.isReadOnly"-->
                                </mat-form-field>
                            </td>
                            &nbsp;
                            <!-- <ng-container
                            *ngIf="showBatchAndLimit()"> -->
                            <td>
                                <mat-form-field appearance="standard" floatLabel="always">
                                    <input matInput placeholder="" min="1" max="50" pattern="[0-9]{1,2}"
                                        value="{{ item.batchSize }}" [(ngModel)]="item.batchSize" type="number"
                                        #batchRef="ngModel" type="number" required />
                                    <!--style="width: 185px;" -->
                                    <!-- [disabled]="model.isReadOnly"-->
                                </mat-form-field>
                            </td>
                            &nbsp;
                            <td>
                                <mat-form-field appearance="standard" floatLabel="always">
                                    <input matInput placeholder="" min="1" max="15000" pattern="[0-9]{1,5}"
                                        value="{{ item.limit }}" [(ngModel)]="item.limit" type="number"
                                        #limitRef="ngModel" required /> <!--style="width: 185px;"-->
                                    <!-- [disabled]="model.isReadOnly"-->
                                </mat-form-field>
                            </td>
                            <!-- </ng-container> -->
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <!-- storage -->
        <div class="table-titleArea" style="padding: 0px 16px 24px 16px">
            <div style="margin-bottom: 8px;">
                <h3 (click)="toggleShowSection('storage')" style="display: flex; justify-content: space-between;"
                    aria-required="true">
                    <h5>Storage
                        <span style="font-size: 12px;"> &#65290; </span>
                    </h5>
                    <mat-icon class="float-right large-icons" style="font-size: large;float: right"
                        [ngClass]="showSection['storage'] ? 'up-arrow' : 'down-arrow'">
                        {{showSection['storage'] ? 'arrow_drop_up' : 'arrow_drop_down'}}
                    </mat-icon>
                </h3>
            </div>
            <div class="tab-data" *ngIf="showSection['storage']">
                <table class="app_tables">
                    <thead>
                        <tr>
                            <th>Storage Type</th>
                            &nbsp;
                            <th>URI</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <mat-form-field appearance="standard" floatLabel="always"
                                    style="width: -webkit-fill-available;">
                                    <mat-select disableOptionCentering class="mat-select-dropdown"
                                        [ngModel]="model.benchmarkData.configuration.dataStorage.storageType"
                                        (ngModelChange)="model.benchmarkData.configuration.dataStorage.storageType = $event">
                                        <mat-option *ngFor="let store of storage" [value]="store.value">
                                            {{ store.viewValue }}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </td>
                            &nbsp;
                            <td>
                                <mat-form-field appearance="standard" floatLabel="always"
                                    style="width: -webkit-fill-available;">
                                    <div class="mat-prefix">
                                        <span>{{model.aiClouds3}}</span>
                                        <input matInput placeholder="bucketName/folderPath" matTooltipPosition="above"
                                            value="{{model.benchmarkData.configuration.dataStorage.uri}}"
                                            [(ngModel)]="model.benchmarkData.configuration.dataStorage.uri" required>

                                        <!-- <mat-placeholder>
                                            <span translate>"bucketNamefolderPath"</span>
                                        </mat-placeholder> -->
                                    </div>
                                </mat-form-field>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <!-- resource configuration -->
        <div class="table-titleArea" style="padding: 0px 16px 16px 16px;">
            <div style="margin-bottom: 8px;">
                <h2 (click)="toggleShowSection('resourceConfig')" style="display: flex; justify-content: space-between;"
                    aria-required="true">
                    <h5>Resource Configuration
                        <span style="font-size: 12px;"> &#65290; </span>
                    </h5>
                    <mat-icon class="float-right large-icons" style="font-size: large;float: right"
                        [ngClass]="showSection['resourceConfig'] ? 'up-arrow' : 'down-arrow'">
                        {{showSection['resourceConfig'] ? 'arrow_drop_up' : 'arrow_drop_down'}}
                    </mat-icon>
                </h2>
            </div>
            <div class="tab-data" *ngIf="showSection['resourceConfig']">
                <table class="app_tables">
                    <thead>
                        <tr>
                            <th width="20%">GPU QTY</th>&nbsp;
                            <th width="20%">GPU Memory</th>&nbsp;
                            <th width="20%">Volume Name</th>&nbsp;
                            <th width="20%">Volume Mount Path</th>&nbsp;
                            <th width="20%">Volume Size</th>&nbsp;
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <mat-form-field appearance="standard" floatLabel="always">
                                    <input matInput placeholder="First Name" min="1"
                                        value="{{ model.benchmarkData.resourceConfig.gpuQty }}"
                                        [(ngModel)]="model.benchmarkData.resourceConfig.gpuQty" type="number" />
                                    <!--style="width: 240px;"-->
                                </mat-form-field>
                            </td>
                            &nbsp;
                            <td>
                                <mat-form-field appearance="standard" floatLabel="always">
                                    <input matInput placeholder="First Name"
                                        value="{{ model.benchmarkData.resourceConfig.gpuMemory }}"
                                        [(ngModel)]="model.benchmarkData.resourceConfig.gpuMemory" disabled />
                                    <!--style="width: 240px;"-->
                                </mat-form-field>
                            </td>
                            &nbsp;
                            <td>
                                <mat-form-field appearance="standard" floatLabel="always">
                                    <input matInput value="{{ model.benchmarkData.resourceConfig.volume.name }}"
                                        [(ngModel)]="model.benchmarkData.resourceConfig.volume.name" required />
                                    <!--style="width: 240px;"-->
                                </mat-form-field>
                            </td>
                            &nbsp;
                            <td>
                                <mat-form-field appearance="standard" floatLabel="always">
                                    <div class="mat-prefix">
                                        &nbsp;
                                        <span>/</span>
                                        &nbsp;
                                        <input matInput
                                            value="{{ model.benchmarkData.resourceConfig.volume.mountPath }}"
                                            [(ngModel)]="model.benchmarkData.resourceConfig.volume.mountPath"
                                            style="width: 200px;" />
                                    </div>
                                    <!--style="width: 240px;"-->
                                </mat-form-field>
                            </td>
                            &nbsp;
                            <td>
                                <mat-form-field appearance="standard" floatLabel="always">
                                    <input matInput placeholder="First Name" min="1" max="100" pattern="[0-9]{1,3}"
                                        type="number" value="{{ model.benchmarkData.resourceConfig.volume.sizeinGB }}"
                                        [(ngModel)]="model.benchmarkData.resourceConfig.volume.sizeinGB"
                                        #volumeRef="ngModel" />
                                    <!--style="width: 240px;"-->
                                </mat-form-field>
                            </td>
                        </tr>
                        <!-- </ng-container> -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<ng-template #confirmAction let-modal let-c="close" let-s="confirm" let-d="dismiss">
    <app-dialog-confirm [isBtnDisabled]="model.isBtnDisabled" (close)="c('Cross click')" (confirm)="createBenchmark()"
        style="box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);">
    </app-dialog-confirm>
</ng-template>